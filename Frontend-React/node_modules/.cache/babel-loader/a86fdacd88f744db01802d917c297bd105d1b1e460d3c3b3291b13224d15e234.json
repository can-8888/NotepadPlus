{"ast":null,"code":"const API_URL = 'http://localhost:5000/api';\n\n// Update the user type at the top of the file\n\n// Update the getCurrentUser function\nconst getCurrentUser = () => {\n  const userJson = localStorage.getItem('user');\n  if (!userJson) return null;\n  try {\n    const user = JSON.parse(userJson);\n    // Validate the user object has required properties\n    if (!user || typeof user.id !== 'number') {\n      return null;\n    }\n    return user;\n  } catch {\n    return null;\n  }\n};\nexport const api = {\n  // Auth operations\n  login: async credentials => {\n    const response = await fetch(`${API_URL}/auth/login`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(credentials)\n    });\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(error || 'Login failed');\n    }\n    return response.json();\n  },\n  register: async userData => {\n    const response = await fetch(`${API_URL}/auth/register`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(userData)\n    });\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(error || 'Registration failed');\n    }\n    return response.json();\n  },\n  // Note operations\n  getNotes: async () => {\n    const response = await fetch(`${API_URL}/notes`);\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(error || 'Failed to fetch notes');\n    }\n    return response.json();\n  },\n  createNote: async note => {\n    const response = await fetch(`${API_URL}/notes`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        title: note.title,\n        content: note.content,\n        category: note.category,\n        userId: note.userId\n      })\n    });\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(error || 'Failed to create note');\n    }\n    return response.json();\n  },\n  updateNote: async (id, note) => {\n    try {\n      const response = await fetch(`${API_URL}/notes/${id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          id,\n          title: note.title || '',\n          content: note.content || '',\n          category: note.category || '',\n          userId: note.userId\n        })\n      });\n      if (!response.ok) {\n        const error = await response.text();\n        throw new Error(error || 'Failed to update note');\n      }\n      const updatedNote = await response.json();\n      return {\n        ...updatedNote,\n        createdAt: new Date(updatedNote.createdAt),\n        updatedAt: new Date(updatedNote.updatedAt)\n      };\n    } catch (err) {\n      console.error('Update error:', err);\n      throw err;\n    }\n  },\n  deleteNote: async id => {\n    const response = await fetch(`${API_URL}/notes/${id}`, {\n      method: 'DELETE'\n    });\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(error || 'Failed to delete note');\n    }\n  },\n  shareNote: async (noteId, collaboratorId) => {\n    const user = getCurrentUser();\n    if (!(user !== null && user !== void 0 && user.id)) {\n      throw new Error('User not authenticated');\n    }\n    const response = await fetch(`${API_URL}/notes/share`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'UserId': user.id.toString()\n      },\n      body: JSON.stringify({\n        noteId,\n        collaboratorId\n      })\n    });\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || 'Failed to share note');\n    }\n  },\n  getSharedNotes: async () => {\n    const user = getCurrentUser();\n    if (!(user !== null && user !== void 0 && user.id)) {\n      throw new Error('User not authenticated');\n    }\n    const response = await fetch(`${API_URL}/notes/shared`, {\n      headers: {\n        'Content-Type': 'application/json',\n        'UserId': user.id.toString()\n      }\n    });\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || 'Failed to fetch shared notes');\n    }\n    const notes = await response.json();\n    return notes.map(note => ({\n      ...note,\n      createdAt: new Date(note.createdAt),\n      updatedAt: new Date(note.updatedAt)\n    }));\n  },\n  makeNotePublic: async id => {\n    const user = getCurrentUser();\n    if (!(user !== null && user !== void 0 && user.id)) {\n      throw new Error('User not authenticated');\n    }\n    const response = await fetch(`${API_URL}/notes/${id}/make-public`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'UserId': user.id.toString()\n      }\n    });\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || 'Failed to make note public');\n    }\n  }\n};","map":{"version":3,"names":["API_URL","getCurrentUser","userJson","localStorage","getItem","user","JSON","parse","id","api","login","credentials","response","fetch","method","headers","body","stringify","ok","error","text","Error","json","register","userData","getNotes","createNote","note","title","content","category","userId","updateNote","updatedNote","createdAt","Date","updatedAt","err","console","deleteNote","shareNote","noteId","collaboratorId","toString","message","getSharedNotes","notes","map","makeNotePublic"],"sources":["D:/_master/v5/notepad-plus/src/services/api.ts"],"sourcesContent":["import { Note, User } from '../types/Note';\r\nimport { LoginRequest, RegisterRequest } from '../types/Auth';\r\n\r\nconst API_URL = 'http://localhost:5000/api';\r\n\r\n// Update the user type at the top of the file\r\ninterface CurrentUser {\r\n    id: number;\r\n    username: string;\r\n}\r\n\r\n// Update the getCurrentUser function\r\nconst getCurrentUser = (): CurrentUser | null => {\r\n    const userJson = localStorage.getItem('user');\r\n    if (!userJson) return null;\r\n    try {\r\n        const user = JSON.parse(userJson);\r\n        // Validate the user object has required properties\r\n        if (!user || typeof user.id !== 'number') {\r\n            return null;\r\n        }\r\n        return user;\r\n    } catch {\r\n        return null;\r\n    }\r\n};\r\n\r\nexport const api = {\r\n    // Auth operations\r\n    login: async (credentials: LoginRequest): Promise<User> => {\r\n        const response = await fetch(`${API_URL}/auth/login`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify(credentials),\r\n        });\r\n        if (!response.ok) {\r\n            const error = await response.text();\r\n            throw new Error(error || 'Login failed');\r\n        }\r\n        return response.json();\r\n    },\r\n\r\n    register: async (userData: RegisterRequest): Promise<User> => {\r\n        const response = await fetch(`${API_URL}/auth/register`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify(userData),\r\n        });\r\n        if (!response.ok) {\r\n            const error = await response.text();\r\n            throw new Error(error || 'Registration failed');\r\n        }\r\n        return response.json();\r\n    },\r\n\r\n    // Note operations\r\n    getNotes: async (): Promise<Note[]> => {\r\n        const response = await fetch(`${API_URL}/notes`);\r\n        if (!response.ok) {\r\n            const error = await response.text();\r\n            throw new Error(error || 'Failed to fetch notes');\r\n        }\r\n        return response.json();\r\n    },\r\n\r\n    createNote: async (note: Partial<Note>): Promise<Note> => {\r\n        const response = await fetch(`${API_URL}/notes`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({\r\n                title: note.title,\r\n                content: note.content,\r\n                category: note.category,\r\n                userId: note.userId\r\n            }),\r\n        });\r\n        if (!response.ok) {\r\n            const error = await response.text();\r\n            throw new Error(error || 'Failed to create note');\r\n        }\r\n        return response.json();\r\n    },\r\n\r\n    updateNote: async (id: number, note: Partial<Note>): Promise<Note> => {\r\n        try {\r\n            const response = await fetch(`${API_URL}/notes/${id}`, {\r\n                method: 'PUT',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    id,\r\n                    title: note.title || '',\r\n                    content: note.content || '',\r\n                    category: note.category || '',\r\n                    userId: note.userId\r\n                }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const error = await response.text();\r\n                throw new Error(error || 'Failed to update note');\r\n            }\r\n\r\n            const updatedNote = await response.json();\r\n            return {\r\n                ...updatedNote,\r\n                createdAt: new Date(updatedNote.createdAt),\r\n                updatedAt: new Date(updatedNote.updatedAt)\r\n            };\r\n        } catch (err) {\r\n            console.error('Update error:', err);\r\n            throw err;\r\n        }\r\n    },\r\n\r\n    deleteNote: async (id: number): Promise<void> => {\r\n        const response = await fetch(`${API_URL}/notes/${id}`, {\r\n            method: 'DELETE',\r\n        });\r\n        if (!response.ok) {\r\n            const error = await response.text();\r\n            throw new Error(error || 'Failed to delete note');\r\n        }\r\n    },\r\n\r\n    shareNote: async (noteId: number, collaboratorId: number): Promise<void> => {\r\n        const user = getCurrentUser();\r\n        if (!user?.id) {\r\n            throw new Error('User not authenticated');\r\n        }\r\n\r\n        const response = await fetch(`${API_URL}/notes/share`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'UserId': user.id.toString()\r\n            },\r\n            body: JSON.stringify({\r\n                noteId,\r\n                collaboratorId\r\n            }),\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const error = await response.json();\r\n            throw new Error(error.message || 'Failed to share note');\r\n        }\r\n    },\r\n\r\n    getSharedNotes: async (): Promise<Note[]> => {\r\n        const user = getCurrentUser();\r\n        if (!user?.id) {\r\n            throw new Error('User not authenticated');\r\n        }\r\n\r\n        const response = await fetch(`${API_URL}/notes/shared`, {\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'UserId': user.id.toString()\r\n            }\r\n        });\r\n        \r\n        if (!response.ok) {\r\n            const error = await response.json();\r\n            throw new Error(error.message || 'Failed to fetch shared notes');\r\n        }\r\n        \r\n        const notes = await response.json();\r\n        return notes.map((note: any) => ({\r\n            ...note,\r\n            createdAt: new Date(note.createdAt),\r\n            updatedAt: new Date(note.updatedAt)\r\n        }));\r\n    },\r\n\r\n    makeNotePublic: async (id: number): Promise<void> => {\r\n        const user = getCurrentUser();\r\n        if (!user?.id) {\r\n            throw new Error('User not authenticated');\r\n        }\r\n\r\n        const response = await fetch(`${API_URL}/notes/${id}/make-public`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'UserId': user.id.toString()\r\n            },\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const error = await response.json();\r\n            throw new Error(error.message || 'Failed to make note public');\r\n        }\r\n    },\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}