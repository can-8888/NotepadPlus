{"ast":null,"code":"import _objectSpread from\"D:/_master/v5/notepad-plus/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useRef,useState}from'react';import'./NoteEditor.css';// Make sure this is the exact path\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const NoteEditor=_ref=>{let{note,onSave,onCancel}=_ref;console.log('NoteEditor rendered with note:',note);const[title,setTitle]=useState((note===null||note===void 0?void 0:note.title)||'');const[content,setContent]=useState((note===null||note===void 0?void 0:note.content)||'');const[category,setCategory]=useState((note===null||note===void 0?void 0:note.category)||'');const[isSaving,setIsSaving]=useState(false);const contentRef=useRef(null);const[undoStack,setUndoStack]=useState([]);const[redoStack,setRedoStack]=useState([]);useEffect(()=>{if(note){setTitle(note.title);setContent(note.content);setCategory(note.category);}else{setTitle('');setContent('');setCategory('');}return()=>{console.log('NoteEditor unmounting');};},[note===null||note===void 0?void 0:note.id]);const handleContentChange=e=>{const newContent=e.target.value;setContent(newContent);addToHistory(newContent);};const handleSave=async()=>{try{setIsSaving(true);await onSave(_objectSpread(_objectSpread({},note||{}),{},{title,content,category}));}finally{setIsSaving(false);}};// Add undo/redo handling\nconst addToHistory=content=>{if(!contentRef.current)return;setUndoStack(prev=>{var _contentRef$current$s,_contentRef$current;return[...prev,{content,cursorPosition:(_contentRef$current$s=(_contentRef$current=contentRef.current)===null||_contentRef$current===void 0?void 0:_contentRef$current.selectionStart)!==null&&_contentRef$current$s!==void 0?_contentRef$current$s:0}];});setRedoStack([]);};const undo=()=>{var _contentRef$current$s2,_contentRef$current2;if(undoStack.length===0)return;const current={content,cursorPosition:(_contentRef$current$s2=(_contentRef$current2=contentRef.current)===null||_contentRef$current2===void 0?void 0:_contentRef$current2.selectionStart)!==null&&_contentRef$current$s2!==void 0?_contentRef$current$s2:0};const previous=undoStack[undoStack.length-1];setRedoStack(prev=>[...prev,current]);setUndoStack(prev=>prev.slice(0,-1));setContent(previous.content);if(contentRef.current){contentRef.current.selectionStart=previous.cursorPosition;contentRef.current.selectionEnd=previous.cursorPosition;}};const redo=()=>{var _contentRef$current$s3,_contentRef$current3;if(redoStack.length===0)return;const current={content,cursorPosition:(_contentRef$current$s3=(_contentRef$current3=contentRef.current)===null||_contentRef$current3===void 0?void 0:_contentRef$current3.selectionStart)!==null&&_contentRef$current$s3!==void 0?_contentRef$current$s3:0};const next=redoStack[redoStack.length-1];setUndoStack(prev=>[...prev,current]);setRedoStack(prev=>prev.slice(0,-1));setContent(next.content);if(contentRef.current){contentRef.current.selectionStart=next.cursorPosition;contentRef.current.selectionEnd=next.cursorPosition;}};// Add keyboard shortcuts\nuseEffect(()=>{const handleKeyDown=e=>{if((e.ctrlKey||e.metaKey)&&e.key==='z'){e.preventDefault();if(e.shiftKey){redo();}else{undo();}}};document.addEventListener('keydown',handleKeyDown);return()=>document.removeEventListener('keydown',handleKeyDown);},[undo,redo]);const handleSubmit=async e=>{e.preventDefault();console.log('Form submitted');await onSave({id:note===null||note===void 0?void 0:note.id,title,content,category,userId:note===null||note===void 0?void 0:note.userId});};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"note-editor\",children:[/*#__PURE__*/_jsx(\"h2\",{children:note?'Edit Note':'Create Note'}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",value:title,onChange:e=>setTitle(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Category\",value:category,onChange:e=>setCategory(e.target.value)}),/*#__PURE__*/_jsxs(\"div\",{className:\"editor-toolbar\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:undo,disabled:undoStack.length===0,children:\"Undo\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:redo,disabled:redoStack.length===0,children:\"Redo\"})]}),/*#__PURE__*/_jsx(\"textarea\",{ref:contentRef,placeholder:\"Note content...\",value:content,onChange:handleContentChange}),/*#__PURE__*/_jsxs(\"div\",{className:\"button-group\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isSaving,children:isSaving?'Saving...':note?'Save':'Create'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onCancel,children:\"Cancel\"})]})]});};export default NoteEditor;","map":{"version":3,"names":["React","useEffect","useRef","useState","jsx","_jsx","jsxs","_jsxs","NoteEditor","_ref","note","onSave","onCancel","console","log","title","setTitle","content","setContent","category","setCategory","isSaving","setIsSaving","contentRef","undoStack","setUndoStack","redoStack","setRedoStack","id","handleContentChange","e","newContent","target","value","addToHistory","handleSave","_objectSpread","current","prev","_contentRef$current$s","_contentRef$current","cursorPosition","selectionStart","undo","_contentRef$current$s2","_contentRef$current2","length","previous","slice","selectionEnd","redo","_contentRef$current$s3","_contentRef$current3","next","handleKeyDown","ctrlKey","metaKey","key","preventDefault","shiftKey","document","addEventListener","removeEventListener","handleSubmit","userId","onSubmit","className","children","type","placeholder","onChange","onClick","disabled","ref"],"sources":["D:/_master/v5/notepad-plus/src/components/NoteEditor.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { Note } from '../types/Note';\nimport './NoteEditor.css';  // Make sure this is the exact path\n\ninterface NoteEditorProps {\n    note?: Note;\n    onSave: (note: Partial<Note>) => Promise<void>;\n    onCancel: () => void;\n}\n\ninterface HistoryEntry {\n    content: string;\n    cursorPosition: number;\n}\n\nconst NoteEditor: React.FC<NoteEditorProps> = ({ note, onSave, onCancel }) => {\n    console.log('NoteEditor rendered with note:', note);\n\n    const [title, setTitle] = useState(note?.title || '');\n    const [content, setContent] = useState(note?.content || '');\n    const [category, setCategory] = useState(note?.category || '');\n    const [isSaving, setIsSaving] = useState(false);\n    const contentRef = useRef<HTMLTextAreaElement>(null);\n    const [undoStack, setUndoStack] = useState<HistoryEntry[]>([]);\n    const [redoStack, setRedoStack] = useState<HistoryEntry[]>([]);\n\n    useEffect(() => {\n        if (note) {\n            setTitle(note.title);\n            setContent(note.content);\n            setCategory(note.category);\n        } else {\n            setTitle('');\n            setContent('');\n            setCategory('');\n        }\n\n        return () => {\n            console.log('NoteEditor unmounting');\n        };\n    }, [note?.id]);\n\n    const handleContentChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n        const newContent = e.target.value;\n        setContent(newContent);\n        addToHistory(newContent);\n    };\n\n    const handleSave = async () => {\n        try {\n            setIsSaving(true);\n            await onSave({\n                ...(note || {}),\n                title,\n                content,\n                category\n            });\n        } finally {\n            setIsSaving(false);\n        }\n    };\n\n    // Add undo/redo handling\n    const addToHistory = (content: string) => {\n        if (!contentRef.current) return;\n\n        setUndoStack(prev => [...prev, {\n            content,\n            cursorPosition: contentRef.current?.selectionStart ?? 0\n        }]);\n        setRedoStack([]);\n    };\n\n    const undo = () => {\n        if (undoStack.length === 0) return;\n\n        const current = {\n            content,\n            cursorPosition: contentRef.current?.selectionStart ?? 0\n        };\n        const previous = undoStack[undoStack.length - 1];\n\n        setRedoStack(prev => [...prev, current]);\n        setUndoStack(prev => prev.slice(0, -1));\n        setContent(previous.content);\n\n        if (contentRef.current) {\n            contentRef.current.selectionStart = previous.cursorPosition;\n            contentRef.current.selectionEnd = previous.cursorPosition;\n        }\n    };\n\n    const redo = () => {\n        if (redoStack.length === 0) return;\n\n        const current = {\n            content,\n            cursorPosition: contentRef.current?.selectionStart ?? 0\n        };\n        const next = redoStack[redoStack.length - 1];\n\n        setUndoStack(prev => [...prev, current]);\n        setRedoStack(prev => prev.slice(0, -1));\n        setContent(next.content);\n\n        if (contentRef.current) {\n            contentRef.current.selectionStart = next.cursorPosition;\n            contentRef.current.selectionEnd = next.cursorPosition;\n        }\n    };\n\n    // Add keyboard shortcuts\n    useEffect(() => {\n        const handleKeyDown = (e: KeyboardEvent) => {\n            if ((e.ctrlKey || e.metaKey) && e.key === 'z') {\n                e.preventDefault();\n                if (e.shiftKey) {\n                    redo();\n                } else {\n                    undo();\n                }\n            }\n        };\n\n        document.addEventListener('keydown', handleKeyDown);\n        return () => document.removeEventListener('keydown', handleKeyDown);\n    }, [undo, redo]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        console.log('Form submitted');\n        await onSave({\n            id: note?.id,\n            title,\n            content,\n            category,\n            userId: note?.userId\n        });\n    };\n\n    return (\n        <form onSubmit={handleSubmit} className=\"note-editor\">\n            <h2>{note ? 'Edit Note' : 'Create Note'}</h2>\n            <input\n                type=\"text\"\n                placeholder=\"Title\"\n                value={title}\n                onChange={(e) => setTitle(e.target.value)}\n            />\n            <input\n                type=\"text\"\n                placeholder=\"Category\"\n                value={category}\n                onChange={(e) => setCategory(e.target.value)}\n            />\n            <div className=\"editor-toolbar\">\n                <button type=\"button\" onClick={undo} disabled={undoStack.length === 0}>\n                    Undo\n                </button>\n                <button type=\"button\" onClick={redo} disabled={redoStack.length === 0}>\n                    Redo\n                </button>\n            </div>\n            \n            <textarea\n                ref={contentRef}\n                placeholder=\"Note content...\"\n                value={content}\n                onChange={handleContentChange}\n            />\n            <div className=\"button-group\">\n                <button \n                    type=\"submit\"\n                    disabled={isSaving}\n                >\n                    {isSaving ? 'Saving...' : (note ? 'Save' : 'Create')}\n                </button>\n                <button type=\"button\" onClick={onCancel}>Cancel</button>\n            </div>\n        </form>\n    );\n};\n\nexport default NoteEditor;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}