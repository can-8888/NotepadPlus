{"ast":null,"code":"import React,{useState,useEffect}from'react';import{api,getCurrentUser}from'../services/api';import'./ShareNoteDialog.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const ShareNoteDialog=_ref=>{let{noteId,onShare,onClose}=_ref;const[searchTerm,setSearchTerm]=useState('');const[users,setUsers]=useState([]);const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(null);useEffect(()=>{const searchUsers=async()=>{if(!searchTerm||searchTerm.length<2){setUsers([]);return;}try{setIsLoading(true);setError(null);const results=await api.searchUsers(searchTerm);console.log('Search results:',results);const usersList=results.users||[];const currentUser=getCurrentUser();const filteredUsers=usersList.filter(user=>user.id!==(currentUser===null||currentUser===void 0?void 0:currentUser.id));setUsers(filteredUsers);}catch(err){console.error('Search error:',err);setError('Failed to search users');setUsers([]);}finally{setIsLoading(false);}};const debounceTimer=setTimeout(searchUsers,300);return()=>clearTimeout(debounceTimer);},[searchTerm]);return/*#__PURE__*/_jsxs(\"div\",{className:\"share-dialog\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Share Note\"}),/*#__PURE__*/_jsx(\"div\",{className:\"search-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Type at least 2 characters to search users...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"search-input\",autoFocus:true})}),/*#__PURE__*/_jsxs(\"div\",{className:\"users-list\",children:[isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Searching users...\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error}),!isLoading&&!error&&searchTerm.length<2&&/*#__PURE__*/_jsx(\"div\",{className:\"search-hint\",children:\"Type at least 2 characters to search\"}),!isLoading&&!error&&searchTerm.length>=2&&users.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"no-results\",children:\"No users found\"}),users.map(user=>/*#__PURE__*/_jsxs(\"div\",{className:\"user-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"username\",children:user.username}),user.email&&/*#__PURE__*/_jsx(\"span\",{className:\"email\",children:user.email})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onShare(user.id),children:\"Share\"})]},user.id))]}),/*#__PURE__*/_jsx(\"div\",{className:\"dialog-actions\",children:/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"cancel-button\",children:\"Cancel\"})})]});};","map":{"version":3,"names":["React","useState","useEffect","api","getCurrentUser","jsx","_jsx","jsxs","_jsxs","ShareNoteDialog","_ref","noteId","onShare","onClose","searchTerm","setSearchTerm","users","setUsers","isLoading","setIsLoading","error","setError","searchUsers","length","results","console","log","usersList","currentUser","filteredUsers","filter","user","id","err","debounceTimer","setTimeout","clearTimeout","className","children","type","placeholder","value","onChange","e","target","autoFocus","map","username","email","onClick"],"sources":["D:/_master/v5/NotepadPlus/Frontend-React/src/components/ShareNoteDialog.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { User } from '../types/Auth';\r\nimport { api, getCurrentUser } from '../services/api';\r\nimport './ShareNoteDialog.css';\r\n\r\ninterface ShareNoteDialogProps {\r\n    noteId: number;\r\n    onShare: (userId: number) => void;\r\n    onClose: () => void;\r\n}\r\n\r\nexport const ShareNoteDialog: React.FC<ShareNoteDialogProps> = ({ noteId, onShare, onClose }) => {\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [users, setUsers] = useState<User[]>([]);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    useEffect(() => {\r\n        const searchUsers = async () => {\r\n            if (!searchTerm || searchTerm.length < 2) {\r\n                setUsers([]);\r\n                return;\r\n            }\r\n\r\n            try {\r\n                setIsLoading(true);\r\n                setError(null);\r\n                const results = await api.searchUsers(searchTerm);\r\n                console.log('Search results:', results);\r\n                \r\n                const usersList = results.users || [];\r\n                const currentUser = getCurrentUser();\r\n                const filteredUsers = usersList.filter(user => user.id !== currentUser?.id);\r\n                \r\n                setUsers(filteredUsers);\r\n            } catch (err) {\r\n                console.error('Search error:', err);\r\n                setError('Failed to search users');\r\n                setUsers([]);\r\n            } finally {\r\n                setIsLoading(false);\r\n            }\r\n        };\r\n\r\n        const debounceTimer = setTimeout(searchUsers, 300);\r\n        return () => clearTimeout(debounceTimer);\r\n    }, [searchTerm]);\r\n\r\n    return (\r\n        <div className=\"share-dialog\">\r\n            <h2>Share Note</h2>\r\n            <div className=\"search-container\">\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"Type at least 2 characters to search users...\"\r\n                    value={searchTerm}\r\n                    onChange={(e) => setSearchTerm(e.target.value)}\r\n                    className=\"search-input\"\r\n                    autoFocus\r\n                />\r\n            </div>\r\n            <div className=\"users-list\">\r\n                {isLoading && <div className=\"loading\">Searching users...</div>}\r\n                {error && <div className=\"error\">{error}</div>}\r\n                {!isLoading && !error && searchTerm.length < 2 && (\r\n                    <div className=\"search-hint\">Type at least 2 characters to search</div>\r\n                )}\r\n                {!isLoading && !error && searchTerm.length >= 2 && users.length === 0 && (\r\n                    <div className=\"no-results\">No users found</div>\r\n                )}\r\n                {users.map(user => (\r\n                    <div key={user.id} className=\"user-item\">\r\n                        <div className=\"user-info\">\r\n                            <span className=\"username\">{user.username}</span>\r\n                            {user.email && <span className=\"email\">{user.email}</span>}\r\n                        </div>\r\n                        <button onClick={() => onShare(user.id)}>Share</button>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n            <div className=\"dialog-actions\">\r\n                <button onClick={onClose} className=\"cancel-button\">Cancel</button>\r\n            </div>\r\n        </div>\r\n    );\r\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}